<script lang="ts">
	import { DropdownMenu } from 'bits-ui';
	import { createEventDispatcher, getContext, onMount } from 'svelte';

	import { flyAndScale } from '$lib/utils/transitions';
	import { goto } from '$app/navigation';
	import ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';
	import { showSettings, activeUserIds, USAGE_POOL, mobile, showSidebar } from '$lib/stores';
	import { fade, slide } from 'svelte/transition';
	import Tooltip from '$lib/components/common/Tooltip.svelte';
	import { userSignOut } from '$lib/apis/auths';

	const i18n = getContext('i18n');

	export let show = false;
	export let role = '';
	export let className = 'max-w-[240px]';

	const dispatch = createEventDispatcher();
</script>

<DropdownMenu.Root
	bind:open={show}
	onOpenChange={(state) => {
		dispatch('change', state);
	}}
>
	<DropdownMenu.Trigger>
		<slot />
	</DropdownMenu.Trigger>

	<slot name="content">
		<DropdownMenu.Content
		class="w-full {className} text-sm rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg font-primary"
		sideOffset={8}
   	 	side="bottom"
    	align="start"
    	transition={(e) => fade(e, { duration: 100 })}
	>
			<button
				class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
				on:click={async () => {
					await showSettings.set(true);
					show = false;

					if ($mobile) {
						showSidebar.set(false);
					}
				}}
			>
				<div class=" self-center mr-3">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						fill="none"
						viewBox="0 0 24 24"
						stroke-width="1.5"
						stroke="currentColor"
						class="w-5 h-5"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"
						/>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
						/>
					</svg>
				</div>
				<div class=" self-center truncate">{$i18n.t('Settings')}</div>
			</button>

			<button
				class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
				on:click={() => {
					dispatch('show', 'archived-chat');
					show = false;

					if ($mobile) {
						showSidebar.set(false);
					}
				}}
			>
				<div class=" self-center mr-3">
					<ArchiveBox className="size-5" strokeWidth="1.5" />
				</div>
				<div class=" self-center truncate">{$i18n.t('Archived Chats')}</div>
			</button>

			{#if role === 'admin'}
				<a
					class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
					href="/playground"
					on:click={() => {
						show = false;

						if ($mobile) {
							showSidebar.set(false);
						}
					}}
				>
					<div class=" self-center mr-3">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke-width="1.5"
							stroke="currentColor"
							class="size-5"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M14.25 9.75 16.5 12l-2.25 2.25m-4.5 0L7.5 12l2.25-2.25M6 20.25h12A2.25 2.25 0 0 0 20.25 18V6A2.25 2.25 0 0 0 18 3.75H6A2.25 2.25 0 0 0 3.75 6v12A2.25 2.25 0 0 0 6 20.25Z"
							/>
						</svg>
					</div>
					<div class=" self-center truncate">{$i18n.t('Playground')}</div>
				</a>

				<a
					class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
					href="/admin"
					on:click={() => {
						show = false;

						if ($mobile) {
							showSidebar.set(false);
						}
					}}
				>
					<div class=" self-center mr-3">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							stroke-width="1.5"
							stroke="currentColor"
							class="w-5 h-5"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z"
							/>
						</svg>
					</div>
					<div class=" self-center truncate">{$i18n.t('Admin Panel')}</div>
				</a>
			{/if}

			<hr class=" border-gray-50 dark:border-gray-850 my-1 p-0" />

			<button
  				class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
  				on:click={() => {
    				window.open('http://localhost:6333/dashboard', '_blank');}}
		>
		<div class="self-center mr-3">
			<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 56 56"
			fill="none"
			stroke-width="1.5"
			stroke="currentColor"
			class="w-5 h-5"
			>
			<path xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" d="M48.8438 14.0017L48.8468 14L36.7206 7L24.5979 0L12.4719 7L0.349609 14L0.350208 14.0016V41.9996L12.4729 48.9996L24.5988 56V56.0007L32.3558 51.5252L32.3561 51.5246L32.3558 51.5244V42L24.5989 46.4796L16.5957 41.8604L8.59623 37.2415V18.7626L16.5957 14.1437L24.5989 9.52477L32.5983 14.1437L40.6015 18.7626V56.0004L40.6009 56L40.602 56.0025L48.8477 51.2436V14.0022L48.8438 14.0017ZM24.5989 36.9585L32.3558 32.4793V23.5244L24.5989 19.0451L16.8419 23.5244V32.4793L24.5989 36.9585Z" fill="white"/>
			</svg>
		</div>
		<div class="self-center truncate">Vector DB</div>
		</button>

		<button
			class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
			on:click={() => {
				window.open('http://localhost:3001', '_blank');
			}}
			>
			<div class="self-center mr-3">
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 256 256" version="1.1" preserveAspectRatio="xMidYMid">
					<title>SingleStore</title>
					<defs>
						<linearGradient x1="67.3449258%" y1="-26.0044686%" x2="-18.5227789%" y2="22.9877555%" id="singleStoreLinearGradient-1">
							<stop stop-color="#FF7BFF" offset="0%"/>
							<stop stop-color="#AA00FF" offset="35.0158%"/>
							<stop stop-color="#8800CC" offset="100%"/>
						</linearGradient>
						<linearGradient x1="36.2591509%" y1="-19.3628763%" x2="111.72205%" y2="44.9975357%" id="singleStoreLinearGradient-2">
							<stop stop-color="#FF7BFF" offset="3.54358%"/>
							<stop stop-color="#8800CC" offset="57.6537%"/>
							<stop stop-color="#311B92" offset="100%"/>
						</linearGradient>
					</defs>
					<g>
						<path d="M133.793438,0 C161.220114,7.62806846 186.208847,26.8506986 196.569923,50.3452712 C212.416431,88.4856134 208.759637,136.695058 191.389506,165.376569 C176.761849,188.8709 154.211058,201.381085 128.308006,201.075829 C88.0823106,200.770814 55.4752171,168.732936 55.1704441,128.456768 C55.1704441,88.1803574 86.8634599,54.9221798 128.308006,54.9221798 C135.012288,54.9221798 144.679052,55.851955 155.649674,60.4286222 C155.649674,60.4286222 147.762766,55.757287 127.50695,52.6192355 C69.3015772,44.9912153 0.621898574,89.095884 16.4683968,190.701711 C38.409617,229.757339 80.4639504,256.303989 128.308006,255.997284 C198.703093,255.692994 256.299161,198.024717 255.996071,127.236226 C255.996071,59.498847 200.836263,1.83073691 133.793438,0 Z" fill="url(#singleStoreLinearGradient-1)"/>
						<path d="M181.635561,54.0037552 C171.884031,33.5605356 151.771183,17.3889203 127.087223,10.9813448 C121.601791,9.45574074 115.811828,8.84547014 109.412318,8.540359 C99.9653199,8.540359 90.8230945,9.76087603 81.376096,12.2018618 C57.9109865,19.2196838 41.455174,32.950265 31.7034025,43.6293966 C19.20906,57.9701518 10.9810571,72.9211776 6.1052197,87.8722034 C6.1052197,88.1774594 5.8004708,88.4824739 5.8004708,89.0927445 C5.4957219,90.3132857 4.27677462,93.9746678 4.27677462,94.8901944 C3.97202572,95.500465 3.97202572,96.4157502 3.66730098,97.0260207 C3.36255208,98.2465619 3.05780318,99.4668616 2.75307844,100.687403 C2.75307844,100.992659 2.75307844,101.297673 2.44832954,101.602688 C-5.47492441,140.963571 7.68750379,176.286091 15.6107577,189.406305 C17.5925312,192.688049 19.2199033,195.425935 20.8508738,197.938019 C2.87119611,100.298588 54.558966,53.6984992 113.373885,52.477958 C144.152582,51.8679289 174.931278,64.3778723 189.863709,89.3980006 C188.949389,75.6672745 188.035312,68.0392543 181.635561,54.0037552 Z" fill="url(#singleStoreLinearGradient-2)"/>
					</g>
				<path xmlns="http://www.w3.org/2000/svg" d="M133.793438,0 C161.220114,7.62806846 186.208847,26.8506986 196.569923,50.3452712 C212.416431,88.4856134 208.759637,136.695058 191.389506,165.376569 C176.761849,188.8709 154.211058,201.381085 128.308006,201.075829 C88.0823106,200.770814 55.4752171,168.732936 55.1704441,128.456768 C55.1704441,88.1803574 86.8634599,54.9221798 128.308006,54.9221798 C135.012288,54.9221798 144.679052,55.851955 155.649674,60.4286222 C155.649674,60.4286222 147.762766,55.757287 127.50695,52.6192355 C69.3015772,44.9912153 0.621898574,89.095884 16.4683968,190.701711 C38.409617,229.757339 80.4639504,256.303989 128.308006,255.997284 C198.703093,255.692994 256.299161,198.024717 255.996071,127.236226 C255.996071,59.498847 200.836263,1.83073691 133.793438,0 Z"/>
				<path xmlns="http://www.w3.org/2000/svg" d="M181.635561,54.0037552 C171.884031,33.5605356 151.771183,17.3889203 127.087223,10.9813448 C121.601791,9.45574074 115.811828,8.84547014 109.412318,8.540359 C99.9653199,8.540359 90.8230945,9.76087603 81.376096,12.2018618 C57.9109865,19.2196838 41.455174,32.950265 31.7034025,43.6293966 C19.20906,57.9701518 10.9810571,72.9211776 6.1052197,87.8722034 C6.1052197,88.1774594 5.8004708,88.4824739 5.8004708,89.0927445 C5.4957219,90.3132857 4.27677462,93.9746678 4.27677462,94.8901944 C3.97202572,95.500465 3.97202572,96.4157502 3.66730098,97.0260207 C3.36255208,98.2465619 3.05780318,99.4668616 2.75307844,100.687403 C2.75307844,100.992659 2.75307844,101.297673 2.44832954,101.602688 C-5.47492441,140.963571 7.68750379,176.286091 15.6107577,189.406305 C17.5925312,192.688049 19.2199033,195.425935 20.8508738,197.938019 C2.87119611,100.298588 54.558966,53.6984992 113.373885,52.477958 C144.152582,51.8679289 174.931278,64.3778723 189.863709,89.3980006 C188.949389,75.6672745 188.035312,68.0392543 181.635561,54.0037552 Z"/>
				</svg>
			</div>
			<div class="self-center truncate">WF Designer</div>
		</button>

		<button
			class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
			on:click={() => {
				window.open('http://localhost:6888', '_blank');
			}}
			>
			<div class="self-center mr-3">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 30 30"
					stroke-width="1.5"
					stroke="currentColor"
					class="w-5 h-5"
				>
				<path xmlns="http://www.w3.org/2000/svg" d="M26.233,3.588A1.69,1.69,0,1,1,24.473,2a1.67,1.67,0,0,1,1.76,1.585Z" style="fill:#767677"/>
				<path xmlns="http://www.w3.org/2000/svg" d="M16.375,23.111c-4.487,0-8.43-1.61-10.469-3.988a11.162,11.162,0,0,0,20.938,0C24.81,21.5,20.882,23.111,16.375,23.111Z" style="fill:#f37726"/>
				<path xmlns="http://www.w3.org/2000/svg" d="M16.375,7.648c4.487,0,8.43,1.61,10.469,3.988a11.162,11.162,0,0,0-20.938,0C7.945,9.253,11.869,7.648,16.375,7.648Z" style="fill:#f37726"/>
				<path xmlns="http://www.w3.org/2000/svg" d="M10.2,27.739a2.109,2.109,0,1,1-.2-.8,2.129,2.129,0,0,1,.2.8Z" style="fill:#9e9e9e"/>
				<path xmlns="http://www.w3.org/2000/svg" d="M6.416,7.106A1.226,1.226,0,1,1,7.608,5.83,1.241,1.241,0,0,1,6.416,7.106Z" style="fill:#616262"/>
				</svg>
			</div>
			<div class="self-center truncate">Notebook</div>
		</button>

		<button
			class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
			on:click={() => {
				window.open('http://localhost:8080', '_blank');
			}}
			>
			<div class="self-center mr-3">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					fill="none"
					viewBox="0 0 51.2 64"
					stroke-width="1.5"
					stroke="currentColor"
					class="w-5 h-5"
				>
					<path d="M41.6,33.6a15.9747,15.9747,0,0,0-6.9194-13.1724l1.2349-2.47a0.7977,0.7977,0,0,0,0.083-0.3578H36V16A10.4181,10.4181,0,0,0,28,5.88V1.6H26.4V5.6305q-0.3962-0.03-0.8-0.03t-0.8,0.03V3.2H23.2V5.88A10.4181,10.4181,0,0,0,15.2,16v1.6h0.0015a0.7977,0.7977,0,0,0,0.083,0.3578l1.2349,2.47A15.9747,15.9747,0,0,0,9.6,33.6a15.8633,15.8633,0,0,0,3.1646,9.554,16.1356,16.1356,0,0,0,5.54,4.69,16.0231,16.0231,0,0,0,15.2669-0.3683A16.0515,16.0515,0,0,0,41.6,33.6Zm-1.6323-0.96a5.5973,5.5973,0,0,1-3.1494-8.0672A14.3117,14.3117,0,0,1,39.9677,32.64Zm-4.2686-9.3021c-0.0819,0.1236-0.1611,0.2489-0.2349,0.3771a7.2021,7.2021,0,0,0,4.5163,10.5923,14.3318,14.3318,0,0,1-0.5156,3.1645A10.4,10.4,0,0,1,32.6928,22.115c0.1011-0.175,0.2077-0.3469,0.318-0.515h0.0948a1.6132,1.6132,0,0,0,0.384-0.047A14.4689,14.4689,0,0,1,35.6991,23.3379ZM29.5866,39.9425A12.0528,12.0528,0,0,0,19.1951,37.89l-1.7765-5.2146a12.0531,12.0531,0,0,0,6.9725-7.9674l5.4013,1.0674A12.0541,12.0541,0,0,0,33.21,35.8021ZM17.2944,18.4H33.9057l-0.8,1.6H18.0944Zm12.81,5.8059-5.4031-1.0678A12.0506,12.0506,0,0,0,24.8,21.6h6.348A12.041,12.041,0,0,0,30.1048,24.2059ZM23.2,21.6A10.4031,10.4031,0,0,1,11.3031,31.8922a14.4325,14.4325,0,0,1,0.7343-3.133A7.283,7.283,0,0,0,12.8,28.8a7.2081,7.2081,0,0,0,7.2-7.2Zm-5.7976-8.8h5.0989a3.2,3.2,0,1,0,0-1.6H18.228A8.7976,8.7976,0,0,1,34.4,16v0.8H16.8v-0.8A8.7548,8.7548,0,0,1,17.4024,12.8ZM24,12a1.6,1.6,0,1,1,1.6,1.6A1.6019,1.6019,0,0,1,24,12Zm-6.29,9.553a1.6132,1.6132,0,0,0,0.384,0.047H18.4a5.6064,5.6064,0,0,1-5.6,5.6c-0.0335,0-0.0668-0.0019-0.1-0.0025,0.1212-0.2442,0.2483-0.4857,0.3836-0.7229A14.4991,14.4991,0,0,1,17.71,21.553ZM11.2,33.6c0-0.0353,0.0015-0.07,0.0017-0.1057A12.136,12.136,0,0,0,12.8,33.6a11.9717,11.9717,0,0,0,3.1044-0.408l1.7772,5.2166a12.1684,12.1684,0,0,0-1.38,0.6845A11.93,11.93,0,0,0,13.4675,41.36,14.2686,14.2686,0,0,1,11.2,33.6Zm3.23,9.0863a10.4,10.4,0,0,1,16.8771,1.5988,10.4347,10.4347,0,0,1,0.9212,2.1,14.313,14.313,0,0,1-2.9977,1.15,7.2017,7.2017,0,0,0-12.51-2.601A14.5573,14.5573,0,0,1,14.43,42.6863ZM19.0346,46.42c-0.34-0.1742-0.6717-0.3632-0.9965-0.5644a5.62,5.62,0,0,1,1.463-1.22,5.6023,5.6023,0,0,1,8.1564,3.2152A14.45,14.45,0,0,1,25.6,48,14.2432,14.2432,0,0,1,19.0346,46.42Zm14.602-0.8711a12.0727,12.0727,0,0,0-2.847-4.5515l3.6264-4.144a12.1789,12.1789,0,0,0,1.2831,0.8534,11.9742,11.9742,0,0,0,3.2443,1.2892A14.4569,14.4569,0,0,1,33.6366,45.549Z"></path><rect x="30.4" y="13.6" width="1.6" height="1.6"></rect><path d="M36.3126,47.5654l0.9748,1.2688a19.1556,19.1556,0,0,0,7.4948-14.4l-1.5986-0.0684A17.5591,17.5591,0,0,1,36.3126,47.5654Z"></path><path d="M44.7822,32.7658c-0.0239-0.557-0.0723-1.1185-0.144-1.6691l-1.5866,0.2066c0.0657,0.505,0.11,1.02,0.132,1.5309Z"></path><path d="M13.3566,20.9565l-1.1132-1.1493A19.0463,19.0463,0,0,0,6.4,33.6a19.3849,19.3849,0,0,0,0.2893,3.3382l1.576-0.2764A17.7745,17.7745,0,0,1,8,33.6,17.459,17.459,0,0,1,13.3566,20.9565Z"></path>
				</svg>
			</div>
			<div class="self-center truncate">AG Designer</div>
		</button>

		<button
			class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
			on:click={() => {
				window.open('http://localhost:3003', '_blank');
			}}
			>
			<div class="self-center mr-3">
				<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 512 512" fill="none">
					<path d="M457 357.752C434.447 388.263 399.909 408.62 360.938 411.591C359.724 411.676 358.511 411.761 357.28 411.829C311.584 414.104 277.065 393.256 254.175 373.9C213.67 352.456 181.979 347.056 163.437 342.387C149.952 338.991 138.153 332.2 133.096 328.804C128.613 326.138 119.595 319.958 112.869 308.43C105.335 295.509 104.896 283.166 105.014 277.92C108.942 277.393 114.015 276.816 119.949 276.442C124.803 276.137 129.506 276.018 134.782 276.001C175.708 275.95 207.448 277.953 230.541 288.208C243.031 293.743 254.611 301.112 264.927 310.094C278.192 321.673 305.313 339.976 338.739 333.728C342.986 332.93 347.066 331.877 350.993 330.587C363.028 328.855 383.609 327.463 407.848 333.898C430.856 340.01 447.409 350.571 457 357.752Z" fill="#0A60B5" stroke="black" stroke-width="8" stroke-miterlimit="10"/>
					<path d="M454 147.632C443.832 134.459 431.474 122.006 416.878 113.508C401.324 104.458 381.476 96.6646 357.471 94.5528C298.821 89.3907 258.722 121.922 251.416 128.073C242.326 136.604 205.964 166.789 162.196 183.549C154.57 186.264 139.891 192.683 126.844 207.013C116.525 218.343 111.475 229.94 109 237.147C114.219 237.868 119.605 238.388 125.161 238.706C167.599 241.069 204.062 241.304 227.916 229.622C243.673 221.912 257.493 210.935 269.412 198.08C290.892 174.9 322.22 164.56 350.737 171.649C363.834 173.476 386.644 174.867 413.023 166.789C431.238 161.208 444.809 154.185 454 147.632Z" fill="#0A60B5" stroke="black" stroke-width="8" stroke-miterlimit="10"/>
					<path d="M56 157.414C39.7299 149.051 27.0288 139.404 18.366 131.853C13.5235 127.629 6 131.092 6 137.546V190.307C6 192.605 7.03887 194.784 8.81501 196.203L30.4303 217C31.5697 208.637 34.0161 197.267 39.5121 184.698C44.6897 172.838 50.9062 163.766 56 157.414Z" fill="#0A60B5" stroke="black" stroke-width="8" stroke-miterlimit="10"/>
					<path d="M404 275.157C406.473 267.536 407.845 259.542 408.049 251.396C408.218 244.96 407.473 242.555 406.355 236.323C417.857 234.392 432.222 231.242 445.317 227.855C459.157 224.282 469.389 220.132 480.891 216C482.568 224.045 484.33 227.957 484.939 233.918C485.515 239.541 485.871 245.367 485.973 251.396C486.278 270.127 483.991 287.113 480.467 302C469.626 296.377 456.751 290.551 441.929 285.437C428.14 280.661 415.316 277.409 404 275.157Z" fill="#0A60B5" stroke="black" stroke-width="8" stroke-miterlimit="10"/>
					<path d="M17.8633 386.557C12.9035 390.158 6 386.608 6 380.438V315.638C6 313.677 6.75402 311.817 8.06099 310.431C8.71448 309.738 9.31769 309.349 9.58579 309.197L31 300C32.5751 308.588 35.1723 318.867 39.5121 330.058C44.5891 343.143 50.6213 353.743 56 361.807C43.2822 370.057 30.5643 378.307 17.8633 386.557Z" fill="#0A60B5" stroke="black" stroke-width="8" stroke-miterlimit="10"/>
					<path fill-rule="evenodd" clip-rule="evenodd" d="M155.765 103.453C198.594 101.328 230.622 119.267 247.13 131.257C234.633 142.295 200.817 168.932 160.818 184.316C158.121 185.28 154.541 186.71 150.462 188.793C121.52 203.048 104.31 231.457 103.542 261.808C103.413 266.916 103.673 272.006 104.349 277.007C104.276 277.016 104.203 277.026 104.131 277.036C104.013 282.241 104.451 294.488 111.981 307.308C118.703 318.747 127.716 324.879 132.197 327.524C134.42 329.006 137.949 331.141 142.351 333.354C147.523 336.109 153.257 338.42 159.582 340.207C160.551 340.488 161.531 340.753 162.52 341.001C164.821 341.576 167.33 342.171 170.036 342.814C189.12 347.343 218.035 354.206 253.489 372.84C257.07 375.846 260.929 378.875 265.067 381.836C263.81 382.961 262.751 383.944 261.896 384.751C254.585 390.934 214.457 423.632 155.765 418.444C131.742 416.321 111.864 408.488 96.3149 399.391C70.119 384.077 50.3247 359.853 39.5263 331.5C32.5688 313.222 26.5041 289.587 26.0661 261.774C25.6787 238.021 29.4859 217.098 34.6745 199.746C50.5605 146.731 96.8876 107.85 152.11 103.689C153.322 103.605 154.535 103.52 155.765 103.453ZM455.742 356.124C446.129 349.001 429.635 338.603 406.79 332.577C382.565 326.193 361.996 327.574 349.968 329.292C346.042 330.573 341.966 331.617 337.72 332.409C304.314 338.608 277.209 320.448 263.951 308.959C261.373 306.731 258.716 304.603 255.986 302.578C264.908 294.736 274.719 287.969 285.414 282.714C309.285 270.989 345.774 271.225 388.243 273.583C446.767 276.851 487.198 304.732 503.336 317.535C505.139 318.967 506.166 321.123 506.166 323.414V376.025C506.166 382.477 498.602 385.93 493.734 381.702C485.011 374.15 472.183 364.489 455.742 356.124ZM268.112 198.921C264.275 203.078 260.24 207.04 256.008 210.76C264.204 216.84 273.061 221.988 282.432 226.11C305.511 236.285 337.233 238.273 378.135 238.223C438.125 238.139 482.295 215.548 502.561 203.25C504.802 201.886 506.166 199.46 506.166 196.832V132.26C506.166 126.111 499.226 122.574 494.239 126.162C482.435 134.658 464.882 145.501 442.244 154.031C434.092 158.837 423.933 163.744 411.827 167.469C385.429 175.589 362.602 174.191 349.496 172.355C320.959 165.229 289.608 175.623 268.112 198.921Z" fill="#E11312"/>
					<path d="M247.13 131.257L249.779 134.255L253.518 130.952L249.481 128.02L247.13 131.257ZM155.765 103.453L155.567 99.458L155.557 99.4585L155.546 99.4591L155.765 103.453ZM160.818 184.316L162.165 188.082L162.21 188.066L162.254 188.049L160.818 184.316ZM150.462 188.793L152.23 192.381L152.256 192.368L152.281 192.355L150.462 188.793ZM103.542 261.808L99.5432 261.706L99.5432 261.706L103.542 261.808ZM104.349 277.007L104.873 280.972L108.85 280.447L108.313 276.471L104.349 277.007ZM104.131 277.036L103.603 273.071L100.209 273.522L100.132 276.945L104.131 277.036ZM111.981 307.308L108.532 309.334L108.532 309.335L111.981 307.308ZM132.197 327.524L134.415 324.195L134.324 324.135L134.23 324.079L132.197 327.524ZM142.351 333.354L144.232 329.824L144.19 329.801L144.148 329.78L142.351 333.354ZM159.582 340.207L160.696 336.365L160.683 336.361L160.67 336.358L159.582 340.207ZM162.52 341.001L163.49 337.12L163.49 337.12L162.52 341.001ZM170.036 342.814L170.96 338.922L170.96 338.922L170.036 342.814ZM253.489 372.84L256.061 369.776L255.731 369.5L255.35 369.299L253.489 372.84ZM265.067 381.836L267.734 384.817L271.453 381.489L267.395 378.584L265.067 381.836ZM261.896 384.751L264.479 387.806L264.563 387.735L264.643 387.659L261.896 384.751ZM155.765 418.444L156.117 414.459L156.117 414.459L155.765 418.444ZM96.3149 399.391L98.3348 395.938L98.3335 395.937L96.3149 399.391ZM39.5263 331.5L35.7879 332.923L35.7882 332.924L39.5263 331.5ZM26.0661 261.774L30.0656 261.711L30.0656 261.709L26.0661 261.774ZM34.6745 199.746L30.8429 198.598L30.8422 198.6L34.6745 199.746ZM152.11 103.689L151.832 99.6985L151.821 99.6994L151.809 99.7002L152.11 103.689ZM406.79 332.577L407.81 328.71L407.809 328.71L406.79 332.577ZM455.742 356.124L453.361 359.338L453.63 359.537L453.928 359.689L455.742 356.124ZM349.968 329.292L349.402 325.333L349.058 325.382L348.727 325.49L349.968 329.292ZM337.72 332.409L338.45 336.342L338.454 336.341L337.72 332.409ZM263.951 308.959L266.57 305.936L266.567 305.933L263.951 308.959ZM255.986 302.578L253.345 299.574L249.627 302.842L253.603 305.791L255.986 302.578ZM285.414 282.714L283.65 279.123L283.649 279.124L285.414 282.714ZM388.243 273.583L388.466 269.589L388.465 269.589L388.243 273.583ZM503.336 317.535L505.824 314.403L505.822 314.401L503.336 317.535ZM493.734 381.702L496.357 378.682L496.352 378.678L493.734 381.702ZM256.008 210.76L253.367 207.755L249.649 211.023L253.625 213.972L256.008 210.76ZM268.112 198.921L271.051 201.634L271.052 201.634L268.112 198.921ZM282.432 226.11L284.045 222.45L284.043 222.449L282.432 226.11ZM378.135 238.223L378.14 242.223L378.141 242.223L378.135 238.223ZM502.561 203.25L504.636 206.67L504.642 206.666L502.561 203.25ZM494.239 126.162L491.903 122.915L491.903 122.915L494.239 126.162ZM442.244 154.031L440.834 150.288L440.511 150.41L440.213 150.585L442.244 154.031ZM411.827 167.469L413.003 171.293L413.004 171.292L411.827 167.469ZM349.496 172.355L348.527 176.236L348.732 176.287L348.941 176.316L349.496 172.355ZM249.481 128.02C232.563 115.733 199.644 97.2715 155.567 99.458L155.963 107.448C197.545 105.385 228.681 122.801 244.78 134.493L249.481 128.02ZM162.254 188.049C202.878 172.424 237.107 145.447 249.779 134.255L244.482 128.259C232.16 139.143 198.755 165.439 159.383 180.582L162.254 188.049ZM152.281 192.355C156.176 190.367 159.593 189.002 162.165 188.082L159.472 180.549C156.648 181.559 152.905 183.054 148.644 185.23L152.281 192.355ZM107.541 261.909C108.272 233.012 124.652 205.965 152.23 192.381L148.695 185.204C118.388 200.132 100.348 229.903 99.5432 261.706L107.541 261.909ZM108.313 276.471C107.667 271.691 107.417 266.814 107.541 261.909L99.5432 261.706C99.4089 267.017 99.6796 272.32 100.385 277.542L108.313 276.471ZM104.659 281.001C104.729 280.991 104.801 280.982 104.873 280.972L103.825 273.041C103.751 273.051 103.677 273.061 103.603 273.071L104.659 281.001ZM115.43 305.282C108.431 293.366 108.02 281.968 108.13 277.126L100.132 276.945C100.006 282.514 100.471 295.611 108.532 309.334L115.43 305.282ZM134.23 324.079C130.058 321.616 121.675 315.91 115.43 305.282L108.532 309.335C115.73 321.583 125.373 328.141 130.163 330.968L134.23 324.079ZM144.148 329.78C139.892 327.641 136.505 325.588 134.415 324.195L129.978 330.852C132.336 332.424 136.005 334.641 140.555 336.928L144.148 329.78ZM160.67 336.358C154.605 334.644 149.138 332.437 144.232 329.824L140.47 336.884C145.907 339.781 151.909 342.195 158.494 344.056L160.67 336.358ZM163.49 337.12C162.551 336.885 161.619 336.633 160.696 336.365L158.468 344.049C159.482 344.343 160.51 344.621 161.55 344.881L163.49 337.12ZM170.96 338.922C168.248 338.278 165.764 337.688 163.49 337.12L161.55 344.881C163.879 345.463 166.412 346.065 169.112 346.705L170.96 338.922ZM255.35 369.299C219.436 350.423 190.118 343.469 170.96 338.922L169.112 346.705C188.121 351.217 216.635 357.989 251.628 376.381L255.35 369.299ZM267.395 378.584C263.35 375.688 259.572 372.724 256.061 369.776L250.918 375.904C254.569 378.969 258.509 382.061 262.738 385.089L267.395 378.584ZM264.643 387.659C265.477 386.871 266.509 385.913 267.734 384.817L262.399 378.855C261.111 380.009 260.026 381.016 259.15 381.843L264.643 387.659ZM155.413 422.428C215.755 427.763 256.953 394.17 264.479 387.806L259.313 381.697C252.217 387.698 213.16 419.502 156.117 414.459L155.413 422.428ZM94.2949 402.843C110.265 412.187 130.708 420.245 155.413 422.428L156.117 414.459C132.777 412.397 113.462 404.788 98.3348 395.938L94.2949 402.843ZM35.7882 332.924C46.8925 362.079 67.2678 387.044 94.2962 402.844L98.3335 395.937C72.9702 381.111 53.7568 357.626 43.2643 330.077L35.7882 332.924ZM22.0666 261.837C22.5133 290.2 28.6981 314.297 35.7879 332.923L43.2646 330.077C36.4394 312.147 30.495 288.974 30.0656 261.711L22.0666 261.837ZM30.8422 198.6C25.5545 216.283 21.6715 237.617 22.0667 261.839L30.0656 261.709C29.6858 238.425 33.4173 217.912 38.5069 200.892L30.8422 198.6ZM151.809 99.7002C94.8602 103.991 47.1822 144.07 30.8429 198.598L38.5062 200.894C53.9388 149.392 98.9151 111.709 152.41 107.678L151.809 99.7002ZM155.546 99.4591C154.283 99.5283 153.041 99.6146 151.832 99.6985L152.387 107.679C153.604 107.595 154.788 107.513 155.984 107.447L155.546 99.4591ZM405.77 336.445C427.976 342.302 444.011 352.41 453.361 359.338L458.124 352.91C448.247 345.592 431.295 334.904 407.81 328.71L405.77 336.445ZM350.533 333.252C362.226 331.582 382.223 330.239 405.771 336.445L407.809 328.71C382.907 322.146 361.765 323.566 349.402 325.333L350.533 333.252ZM338.454 336.341C342.869 335.518 347.116 334.43 351.208 333.095L348.727 325.49C344.969 326.715 341.062 327.717 336.987 328.477L338.454 336.341ZM261.331 311.982C274.874 323.717 303.212 342.881 338.45 336.342L336.991 328.476C305.417 334.336 279.544 317.179 266.57 305.936L261.331 311.982ZM253.603 305.791C256.254 307.756 258.833 309.822 261.335 311.985L266.567 305.933C263.913 303.64 261.179 301.449 258.369 299.365L253.603 305.791ZM283.649 279.124C272.604 284.552 262.502 291.526 253.345 299.574L258.627 305.583C267.315 297.947 276.835 291.387 287.178 286.304L283.649 279.124ZM388.465 269.589C367.207 268.409 347.267 267.747 329.599 268.875C311.963 270.001 296.269 272.925 283.65 279.123L287.177 286.304C298.429 280.777 312.915 277.957 330.109 276.859C347.271 275.763 366.809 276.399 388.021 277.577L388.465 269.589ZM505.822 314.401C489.374 301.352 448.16 272.923 388.466 269.589L388.02 277.577C445.373 280.78 485.021 308.111 500.85 320.668L505.822 314.401ZM510.166 323.414C510.166 319.916 508.592 316.601 505.824 314.403L500.848 320.667C501.686 321.332 502.166 322.33 502.166 323.414H510.166ZM510.166 376.025V323.414H502.166V376.025H510.166ZM491.111 384.722C498.574 391.204 510.166 385.9 510.166 376.025H502.166C502.166 379.054 498.631 380.657 496.357 378.682L491.111 384.722ZM453.928 359.689C470.016 367.875 482.577 377.333 491.116 384.726L496.352 378.678C487.445 370.966 474.349 361.104 457.556 352.559L453.928 359.689ZM258.649 213.764C262.992 209.947 267.126 205.887 271.051 201.634L265.173 196.208C261.424 200.269 257.489 204.133 253.367 207.755L258.649 213.764ZM284.043 222.449C274.945 218.447 266.347 213.45 258.391 207.547L253.625 213.972C262.06 220.231 271.177 225.529 280.821 229.772L284.043 222.449ZM378.13 234.223C337.137 234.273 306.243 232.237 284.045 222.45L280.818 229.77C304.779 240.334 337.328 242.273 378.14 242.223L378.13 234.223ZM500.486 199.83C480.555 211.925 437.112 234.14 378.13 234.223L378.141 242.223C439.137 242.137 484.036 219.171 504.636 206.67L500.486 199.83ZM502.166 196.832C502.166 198.064 501.53 199.195 500.481 199.834L504.642 206.666C508.074 204.576 510.166 200.856 510.166 196.832H502.166ZM502.166 132.26V196.832H510.166V132.26H502.166ZM496.576 129.409C498.929 127.715 502.166 129.387 502.166 132.26H510.166C510.166 122.836 499.523 117.432 491.903 122.915L496.576 129.409ZM443.655 157.774C466.697 149.092 484.559 138.057 496.576 129.408L491.903 122.915C480.31 131.258 463.067 141.911 440.834 150.288L443.655 157.774ZM413.004 171.292C425.452 167.461 435.897 162.416 444.276 157.477L440.213 150.585C432.286 155.258 422.413 160.026 410.651 163.646L413.004 171.292ZM348.941 176.316C362.4 178.202 385.861 179.641 413.003 171.293L410.651 163.646C384.997 171.537 362.805 170.18 350.051 168.393L348.941 176.316ZM271.052 201.634C291.669 179.287 321.563 169.503 348.527 176.236L350.465 168.474C320.354 160.955 287.546 171.959 265.172 196.209L271.052 201.634Z" fill="black"/>
					</svg>
			</div>
			<div class="self-center truncate">Observer</div>
		</button>

		<button
			class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
			on:click={() => {
				window.open('http://localhost:6001', '_blank');
			}}
			>
			<div class="self-center mr-3">
				<svg
  					xmlns="http://www.w3.org/2000/svg"
  					viewBox="0 0 24 24"
  					fill="none"
  					stroke="currentColor"
  					stroke-width="2"
  					stroke-linecap="round"
  					stroke-linejoin="round"
  					class="w-5 h-5"
				>
  					<path d="M12 5v14M5 12h14" />
				</svg>
			</div>
			<div class="self-center truncate">Chatter</div>
		</button>

		<hr class=" border-gray-50 dark:border-gray-850 my-1 p-0" />

			<button
				class="flex rounded-md py-2 px-3 w-full hover:bg-gray-50 dark:hover:bg-gray-800 transition"
				on:click={async () => {
					await userSignOut();
					localStorage.removeItem('token');
					location.href = '/auth';
					show = false;
				}}
			>
				<div class=" self-center mr-3">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 20 20"
						fill="currentColor"
						class="w-5 h-5"
					>
						<path
							fill-rule="evenodd"
							d="M3 4.25A2.25 2.25 0 015.25 2h5.5A2.25 2.25 0 0113 4.25v2a.75.75 0 01-1.5 0v-2a.75.75 0 00-.75-.75h-5.5a.75.75 0 00-.75.75v11.5c0 .414.336.75.75.75h5.5a.75.75 0 00.75-.75v-2a.75.75 0 011.5 0v2A2.25 2.25 0 0110.75 18h-5.5A2.25 2.25 0 013 15.75V4.25z"
							clip-rule="evenodd"
						/>
						<path
							fill-rule="evenodd"
							d="M6 10a.75.75 0 01.75-.75h9.546l-1.048-.943a.75.75 0 111.004-1.114l2.5 2.25a.75.75 0 010 1.114l-2.5 2.25a.75.75 0 11-1.004-1.114l1.048-.943H6.75A.75.75 0 016 10z"
							clip-rule="evenodd"
						/>
					</svg>
				</div>
				<div class=" self-center truncate">{$i18n.t('Sign Out')}</div>
			</button>

			

			{#if $activeUserIds?.length > 0}
				<hr class=" border-gray-50 dark:border-gray-850 my-1 p-0" />

				<Tooltip
					content={$USAGE_POOL && $USAGE_POOL.length > 0
						? `${$i18n.t('Running')}: ${$USAGE_POOL.join(', ')} ✨`
						: ''}
				>
					<div class="flex rounded-md py-1.5 px-3 text-xs gap-2.5 items-center">
						<div class=" flex items-center">
							<span class="relative flex size-2">
								<span
									class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"
								/>
								<span class="relative inline-flex rounded-full size-2 bg-green-500" />
							</span>
						</div>

						<div class=" ">
							<span class="">
								{$i18n.t('Active Users')}:
							</span>
							<span class=" font-semibold">
								{$activeUserIds?.length}
							</span>
						</div>
					</div>
				</Tooltip>
			{/if}

			<!-- <DropdownMenu.Item class="flex items-center px-3 py-2 text-sm ">
				<div class="flex items-center">Profile</div>
			</DropdownMenu.Item> -->
		</DropdownMenu.Content>
	</slot>
</DropdownMenu.Root>
